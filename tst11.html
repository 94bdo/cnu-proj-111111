<!DOCTYPE html>
<html>
<head>
  <title>CNU student attendance project</title>
  <script>
    // Your uni coordinates (latitude, longitude)
    const schoolLat = 29.97033683702538;
    const schoolLng = 31.319369079308014;
    const allowedRadius = 0.07; // in km (adjust how close they must be)

    // Form link
    const formLink = "https://forms.gle/6QDKEYorpGbskCtWA";

    function toRad(x) {
      return x * Math.PI / 180;
    }

    function getDistance(lat1, lon1, lat2, lon2) {
      let R = 6371; // Earth radius in km
      let dLat = toRad(lat2-lat1);
      let dLon = toRad(lon2-lon1);
      let a = Math.sin(dLat/2) * Math.sin(dLat/2) +
              Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
              Math.sin(dLon/2) * Math.sin(dLon/2);
      let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    function checkLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          let userLat = position.coords.latitude;
          let userLng = position.coords.longitude;
          let distance = getDistance(userLat, userLng, schoolLat, schoolLng);

          if (distance <= allowedRadius) {
            window.location.href = formLink; // redirect to form
          } else {
            document.getElementById("message").innerHTML = 
              "❌ You must be inside CNU campus to access this Form.";
          }
        }, function() {
          document.getElementById("message").innerHTML = 
            "⚠️ Location access denied.";
        });
      } else {
        document.getElementById("message").innerHTML = 
          "⚠️ Geolocation is not supported on this device.";
      }
    }
  </script>
</head>
<body onload="checkLocation()">
  <h2>Checking location...</h2>
  <p id="message"></p>
</body>
</html>